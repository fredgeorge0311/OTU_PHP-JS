<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>

        <service class="Shopware\Bundle\CustomerSearchBundle\CustomerStream\CustomerProvider" id="shopware_customer_search.customer_stream.customer_provider">
            <argument id="shopware_customer_search.gateway.customer_service" type="service"/>
            <argument id="shopware_customer_search.gateway.customer_order_gateway" type="service"/>
            <argument id="shopware_customer_search.gateway.customer_interests_gateway" type="service"/>
        </service>

        <service class="Shopware\Bundle\CustomerSearchBundle\Gateway\CustomerService" id="shopware_customer_search.gateway.customer_service">
            <argument id="shopware_customer_search.gateway.customer_gateway" type="service"/>
            <argument id="shopware_customer_search.gateway.address_gateway" type="service"/>
        </service>

        <service class="Shopware\Bundle\CustomerSearchBundle\Gateway\PaymentHydrator" id="shopware_customer_search.gateway.payment_hydrator">
            <argument id="shopware_storefront.attribute_hydrator_dbal" type="service"/>
        </service>

        <service class="Shopware\Bundle\CustomerSearchBundle\Gateway\CustomerInterestsGateway" id="shopware_customer_search.gateway.customer_interests_gateway">
            <argument id="dbal_connection" type="service"/>
        </service>

        <service class="Shopware\Bundle\CustomerSearchBundle\Gateway\CustomerGateway" id="shopware_customer_search.gateway.customer_gateway">
            <argument id="dbal_connection" type="service"/>
            <argument id="shopware_storefront.field_helper_dbal" type="service"/>
            <argument id="shopware_customer_search.gateway.customer_hydrator" type="service"/>
        </service>

        <service class="Shopware\Bundle\CustomerSearchBundle\Gateway\CustomerHydrator" id="shopware_customer_search.gateway.customer_hydrator">
            <argument id="shopware_storefront.attribute_hydrator_dbal" type="service"/>
            <argument id="shopware_storefront.customer_group_hydrator_dbal" type="service"/>
            <argument id="shopware_customer_search.gateway.payment_hydrator" type="service"/>
        </service>

        <service class="Shopware\Bundle\CustomerSearchBundle\Gateway\AddressGateway" id="shopware_customer_search.gateway.address_gateway">
            <argument id="dbal_connection" type="service"/>
            <argument id="shopware_storefront.field_helper_dbal" type="service"/>
            <argument id="shopware_customer_search.gateway.address_hydrator" type="service"/>
        </service>

        <service class="Shopware\Bundle\CustomerSearchBundle\Gateway\CustomerOrderGateway" id="shopware_customer_search.gateway.customer_order_gateway">
            <argument id="dbal_connection" type="service"/>
            <argument id="shopware_customer_search.gateway.customer_order_hydrator" type="service"/>
        </service>

        <service class="Shopware\Bundle\CustomerSearchBundle\Gateway\AddressHydrator" id="shopware_customer_search.gateway.address_hydrator">
            <argument id="shopware_storefront.country_hydrator_dbal" type="service"/>
            <argument id="shopware_storefront.attribute_hydrator_dbal" type="service"/>
        </service>

        <service class="Shopware\Bundle\CustomerSearchBundle\Gateway\CustomerOrderHydrator" id="shopware_customer_search.gateway.customer_order_hydrator"/>

        <service class="Shopware\Bundle\CustomerSearchBundle\CustomerStream\SearchIndexer" id="shopware_customer_search.customer_stream.search_indexer">
            <argument id="dbal_connection" type="service"/>
            <argument id="shopware_customer_search.customer_stream.customer_provider" type="service"/>
        </service>


        <service id="shopware_customer_search.customer_number_search" class="Shopware\Bundle\CustomerSearchBundle\CustomerNumberSearch">
            <argument type="service" id="shopware_customer_search.handler_registry"/>
            <argument type="service" id="dbal_connection"/>
            <argument type="service" id="shopware_storefront.field_helper_dbal"/>
        </service>

        <service id="shopware_customer_search.handler_registry" class="Shopware\Bundle\CustomerSearchBundle\HandlerRegistry">
            <argument type="collection"/>
            <argument type="collection"/>
        </service>

        <service class="Shopware\Bundle\CustomerSearchBundle\SortingHandler\FieldSortingHandler" id="shopware_customer_search.sorting_handler.field_sorting_handler">
            <tag name="customer_search_sorting_handler"/>
        </service>

        <service id="shopware_customer_search.has_address_with_country_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\HasAddressWithCountryConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.has_canceled_orders_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\HasCanceledOrdersConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.has_order_count_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\HasOrderCountConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.has_total_order_amount_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\HasTotalOrderAmountConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.is_customer_since_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\IsCustomerSinceConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.is_in_customer_group_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\IsInCustomerGroupConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.ordered_at_weekday_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\OrderedAtWeekdayConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.ordered_in_last_days_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\OrderedInLastDaysConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.ordered_in_shop_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\OrderedInShopConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.ordered_on_device_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\OrderedOnDeviceConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.ordered_product_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\OrderedProductConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.ordered_product_of_category_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\OrderedProductOfCategoryConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.ordered_product_of_manufacturer_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\OrderedProductOfManufacturerConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.ordered_with_delivery_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\OrderedWithDeliveryConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.ordered_with_payment_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\OrderedWithPaymentConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.registered_in_shop_condition_handler" class="Shopware\Bundle\CustomerSearchBundle\ConditionHandler\RegisteredInShopConditionHandler">
            <tag name="customer_search_condition_handler"/>
        </service>

        <service id="shopware_customer_search.stream_indexer" class="Shopware\Bundle\CustomerSearchBundle\CustomerStream\StreamIndexer">
            <argument type="service" id="shopware_customer_search.stream_criteria_factory" />
            <argument type="service" id="shopware_customer_search.customer_number_search" />
            <argument type="service" id="dbal_connection" />
        </service>

        <service id="shopware_customer_search.stream_criteria_factory" class="Shopware\Bundle\CustomerSearchBundle\CustomerStream\CustomerStreamCriteriaFactory">
            <argument type="service" id="dbal_connection" />
            <argument type="service" id="shopware.logaware_reflection_helper" />
        </service>

        <service id="shopware_customer_search.index_populate_command" class="Shopware\Bundle\CustomerSearchBundle\Commands\StreamIndexPopulateCommand">
            <tag name="console.command" />
        </service>

        <service id="shopware_customer_search.search_index_populate_command" class="Shopware\Bundle\CustomerSearchBundle\Commands\SearchIndexPopulateCommand">
            <tag name="console.command" />
        </service>

        <service id="shopware_customer_search.customer_stream.cron_job_subscriber" class="Shopware\Bundle\CustomerSearchBundle\CustomerStream\CronJobSubscriber">
            <argument id="dbal_connection" type="service"/>
            <argument id="shopware_customer_search.customer_stream.search_indexer" type="service"/>
            <argument id="shopware_customer_search.stream_indexer" type="service"/>
            <tag name="shopware.event_subscriber"/>
        </service>

    </services>
</container>
